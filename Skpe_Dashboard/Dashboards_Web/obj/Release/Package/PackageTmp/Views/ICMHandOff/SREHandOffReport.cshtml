@model Dashboards_Web.Models.IcmDataModel
@{
    ViewBag.Title = "SRE Hand Off Report";
}
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
<style>

    .customDropDown {
        color: #fff !important;
        background-color: #607d8b !important;
        text-align: center;
        font-size: 16px;
        height: 35px;
        font-weight: bold;
    }

    .Myspan {
        margin-right: 4px;
        margin-left: 3px;
        font-size: 16px;
        color: #607d8b;
        font-weight: bold;
    }

    input[type=checkbox] {
        width: 20px;
        height: 20px;
        margin-top: 10px;
    }

    th {
        padding-right: 10px;
    }

    .divScroll {
        overflow-y: auto;
        background-color: white;
        max-height: 500px;
        text-align: justify;
    }

    .tblHeading {
        background-color: darkslategray;
        color: whitesmoke;
    }

    .info th {
        background: #607d8b !important;
    }

        .info th a {
            color: white;
            font-weight: bold;
            font-size: medium;
        }

    .info th {
        color: white;
        font-weight: bold;
        font-size: medium;
    }

    .webgrid-footer {
        background: #607d8b;
        text-align: center;
        color: white;
        font-weight: bold;
        font-size: medium;
    }

    .mainText {
        padding: .25%;
        background-color: #808080;
        font-size: 18px;
        color: white;
        font-weight: bold;
        text-align: center;
    }

    #accordion .panel {
        border-radius: 0;
        border: 0;
        margin-top: 0px;
    }

    #accordion .panel-heading a.collapsed:hover,
    #accordion .panel-heading a.collapsed:focus {
        background-color: #607d8b;
        color: white;
        transition: all 0.2s ease-in;
    }

        #accordion .panel-heading a.collapsed:hover::before,
        #accordion .panel-heading a.collapsed:focus::before {
            color: white;
        }

    #accordion .panel-heading {
        padding: 0;
        border-radius: 0px;
        text-align: center;
        background-color: #607d8b;
        color: white;
    }

        #accordion .panel-heading a:not(.collapsed) {
            color: white;
            background-color: #607d8b;
            transition: all 0.2s ease-in;
        }

        /* Add Indicator fontawesome icon to the left */
        #accordion .panel-heading .accordion-toggle::before {
            font-family: 'FontAwesome';
            content: '\f00d';
            float: left;
            color: white;
            font-weight: lighter;
            transform: rotate(0deg);
            transition: all 0.2s ease-in;
        }

        #accordion .panel-heading .accordion-toggle.collapsed::before {
            color: #444;
            transform: rotate(-135deg);
            transition: all 0.2s ease-in;
        }

    .Active {
        color: red;
        font-weight: bold;
    }

    .Resolved {
        color: green;
        font-weight: bold;
    }

    .Mitigated {
        color: orange;
        font-weight: bold;
    }
    /*.nav-tabs > li.active > a, .nav-tabs > li.active > a:focus, .nav-tabs > li.active > a:hover {
        background-color: #607d8b;
        color: white;
    }*/
</style>
<script type="text/javascript">

    $(document).ready(function () {

        CheckBoxUpdate();
        $('input[type="checkbox"]').change(function (event) {
            CheckBoxUpdate();
            if ($("#IsIc3Prov").is(":checked") && $("#IsRtcAppSre").is(":checked") && $("#IsIc3RunTime").is(":checked") && $("#IsGpa").is(":checked") && $("#IsIC3TenantPolicies").is(":checked") && $("#IsTeamsLROS").is(":checked") && $("#IsIC3AdminControls").is(":checked")) {
                $("#AllTrackSre").prop("checked", true);
            }
            else if ($("#IsIc3Prov").is(":checked") == false || $("#IsRtcAppSre").is(":checked") == false || $("#IsIc3RunTime").is(":checked") == false || $("#IsGpa").is(":checked") == false || $("#IsIC3TenantPolicies").is(":checked") == false || $("#IsTeamsLROS").is(":checked") == false || $("#IsIC3AdminControls").is(":checked") == false) {
                $("#AllTrackSre").prop("checked", false);
            }

        });

        $(".AllSre").click(function () {
            if ($("#AllTrackSre").is(":checked")) {
                AllSreCheck();
            }
            else if ($("#AllTrackSre").is(":checked") == false) {
                AllSreUnCheck();
            }
        });

    });

    function CheckBoxUpdate() {
        if ($("#AllTrackSre").is(":checked") || $("#IsIc3Prov").is(":checked") || $("#IsRtcAppSre").is(":checked") || $("#IsIc3RunTime").is(":checked") || $("#IsGpa").is(":checked") || $("#IsIC3TenantPolicies").is(":checked") || $("#IsTeamsLROS").is(":checked") || $("#IsIC3AdminControls").is(":checked")) {
            document.getElementById('sbmt').disabled = false;
        }
        else {
            document.getElementById('sbmt').disabled = true;
        }

    }
    function DropDownDaysList() {
        $("#divGrd").hide();
        $("#cpyEml").hide();
    }

    function AllSreCheck() {
        //if ($("#AllTrackSRE").is(":checked")) {
        //$("#IsBusinessBVD").prop("checked", true);
        $("#IsIc3Prov").prop("checked", true);
        $("#IsRtcAppSre").prop("checked", true);
        $("#IsIc3RunTime").prop("checked", true);
        $("#IsGpa").prop("checked", true);
        $("#IsIC3TenantPolicies").prop("checked", true);
        $("#IsTeamsLROS").prop("checked", true);
        $("#IsIC3AdminControls").prop("checked", true);
        //}
    }
    function AllSreUnCheck() {
        //else if ($("#AllTrackSRE").is(":checked") == false) {
        //  alert($("#AllTrackSRE").is(":unchecked"))
        //$("#IsBusinessBVD").prop("checked", false);
        $("#IsIc3Prov").prop("checked", false);
        $("#IsRtcAppSre").prop("checked", false);
        $("#IsIc3RunTime").prop("checked", false);
        $("#IsGpa").prop("checked", false);
        $("#IsIC3TenantPolicies").prop("checked", false);
        $("#IsTeamsLROS").prop("checked", false);
        $("#IsIC3AdminControls").prop("checked", false);
        //}
    }

    function copyDivToClipboard() {
        var range = document.createRange();
        range.selectNode(document.getElementById("divGrd"));
        window.getSelection().removeAllRanges(); // clear current selection
        window.getSelection().addRange(range); // to select text
        document.execCommand("copy");
        window.getSelection().removeAllRanges();// to deselect
        //hideEmailContentDiv();
        TriggerOutlook();

    }
    function TriggerOutlook() {
        var tracks = "";
            if ($("#IsIc3Prov").is(":checked")) {
                tracks += "IC3 Prov";
            }
            if ($("#IsRtcAppSre").is(":checked")) {
                if (tracks == "") {
                    tracks += "RTCAPPSRE";
                }
                else {
                    tracks += ", RTCAPPSRE";
                }
            }
            if ($("#IsIc3RunTime").is(":checked")) {
                if (tracks == "") {
                    tracks += "IC3 Runtime ST";
                }
                else {
                    tracks += ", IC3 Runtime ST";
                }
        }
        if ($("#IsGpa").is(":checked")) {
            if (tracks == "") {
                tracks += "GPA";
            }
            else {
                tracks += ", GPA";
            }
        }
        if ($("#IsIC3TenantPolicies").is(":checked")) {
            if (tracks == "") {
                tracks += "IC3 Tenant Policies";
            }
            else {
                tracks += ", IC3 Tenant Policies";
            }
        }
        if ($("#IsTeamsLROS").is(":checked")) {
            if (tracks == "") {
                tracks += "Teams LROS";
            }
            else {
                tracks += ", Teams LROS";
            }
        }
        if ($("#IsIC3AdminControls").is(":checked")) {
            if (tracks == "") {
                tracks += "IC3 Admin Controls";
            }
            else {
                tracks += ", IC3 Admin Controls";
            }
        }
            var subject = '@Model.IcmType' + " " + $("#Shift :selected").val() + " (" + '@Model.ShiftInfo' + ") " + "Handoff for " + tracks;
            var body = $("#Shift :selected").val();
            body += "           ";
            body += "Paste Copied data or press (ctrl + v) below";
            window.location.href = "mailto:@Model.HandOffEmail?body=" + body + "&subject=" + subject;

    }
</script>
@using (Html.BeginForm("SREHandOffReport", "ICMHandOff", FormMethod.Get, new { @name = "Form1", id = "form1" }))
{
    <div class="container-fluid">
        <div class="col-sm-12">
            <table style="text-align:center;padding:10px;">
                <thead style="text-align:center !important;">
                    <tr>
                        <th>
                            @Html.DropDownList("Shift", new List<SelectListItem>
                                            {
                                            new SelectListItem{ Text="SHIFT A (India Morning)", Value = "SHIFT A - B (India Morning)" },
                                            new SelectListItem{ Text="SHIFT B (India Noon)", Value = "SHIFT B - C (India Noon)" },
                                            new SelectListItem{ Text="SHIFT C (Redmond)", Value = "SHIFT C - A (Redmond)" },
                                            }, new { @class = "btn dropdown-toggle customDropDown", @onchange = "DropDownDaysList()" })
                        </th>
                        <th>
                            <div id="divSre">
                                @Html.CheckBox("AllTrackSre", Model.AllTrackSre, new { @class = "AllSre" })<span class="Myspan" style="font-weight:bold">All</span>
                                @Html.CheckBox("IsIc3Prov", Model.IsIc3Prov)<span class="Myspan">IC3 Prov</span>
                                @Html.CheckBox("IsRtcAppSre", Model.IsRtcAppSre)<span class="Myspan">RTCAPPSRE</span>
                                @Html.CheckBox("IsIc3RunTime", Model.IsIc3RunTime)<span class="Myspan">IC3 Runtime ST</span>
                                @Html.CheckBox("IsGpa", Model.IsGpa)<span class="Myspan">GPA</span>
                                @Html.CheckBox("IsIC3TenantPolicies", Model.IsIC3TenantPolicies)<span class="Myspan">IC3 Tenant Policies</span>
                                @Html.CheckBox("IsTeamsLROS", Model.IsTeamsLROS)<span class="Myspan">Teams LROS</span>
                                @Html.CheckBox("IsIC3AdminControls", Model.IsIC3AdminControls)<span class="Myspan">IC3 Admin Controls</span>
                            </div>
                        </th>
                        <th>
                            <input type="submit" value="Submit" id="sbmt" class="btn btn-success" style="background-color:#607d8b" disabled="disabled" />
                        </th>
                        @if (Model != null && Model.TtaList != null && Model.TtaList.Count() > 0)
                        {
                            <th><input type="button" value="Copy & Email" id="cpyEml" onclick="copyDivToClipboard()" class="btn btn-success" style="background-color:grey" /></th>
                        }
                    </tr>
                </thead>
            </table>
        </div>
        <br /><br />
        @if (Model != null && Model.TtaList != null && Model.TtaList.Count() > 0)
        {
            <div class="row rowBorder" id="divGrd">

                <div id="accordion" class="panel-group">

                    <div class="panel">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <a href="#panelBodyOne" class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#accordion" style=" display: block; padding: 10px 15px; border-bottom: 1px solid #b42b2b; text-decoration: none;">@Model.IcmType @Model.Shift ICM Count &nbsp;#&nbsp;@ViewBag.GrandTotal</a>
                            </h4>
                        </div>
                        <br />
                        <div id="panelBodyOne" class="panel-collapse collapse in">
                            <div class="panel-body" style="align-content:center">

                                <div style="align-content:center;">
                                    <table class="table table-bordered table-hover">
                                        <thead style="background-color: #607d8b;color: white">
                                            <tr>
                                                <th>Hand Off Given By</th>
                                                <th>Hand Off Taken By</th>
                                                <th>Shift Lead</th>
                                                <th>Team Members</th>
                                                <th>Comments</th>
                                            </tr>
                                        </thead>
                                        <tr>
                                            <td contenteditable="true" title="Write your V- id"></td>
                                            <td contenteditable="true" title="Provide V- id whom you hand off"></td>
                                            <td contenteditable="true" title="Write v- id of shift lead"></td>
                                            <td contenteditable="true" title="Add the team members name"></td>
                                            <td contenteditable="true" title="Add some comments"></td>
                                        </tr>
                                    </table>
                                </div>
                                <br />
                                <div class="row">

                                    @for (int item = 0; item < ViewBag.TeamData.Count; item++)
                                    {
                                        var team = (List<Dashboards_Web.Models.Team>)ViewBag.TeamData;
                                        if (team.ToArray()[item].TeamTotal > 0)
                                        {

                                            <div class="col-lg-5">
                                                <table class="table table-bordered table-hover">
                                                    <thead style="background-color:#607d8b;color:white">
                                                        <tr>
                                                            <th>@team.ToArray()[item].FriendlyName</th>
                                                            <th>Sev1</th>
                                                            <th>Sev2</th>
                                                            <th>Sev3</th>
                                                            <th>Sev4</th>
                                                            <th style="color:orange;font-weight:bold">Total # @team.ToArray()[item].TeamTotal</th>
                                                        </tr>
                                                    </thead>
                                                    @if (team.ToArray()[item].ActiveTotal > 0)
                                                    {
                                                        <tr>
                                                            <td>Active</td>
                                                            @if (team.ToArray()[item].Sev1ActiveCount > 0)
                                                            {
                                                                <td>@Html.ActionLink(@team.ToArray()[item].Sev1ActiveCount.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "1", Status = "Active", TeamName = team.ToArray()[item].TeamVal }, null)</td>
                                                            }
                                                            else
                                                            {
                                                                <td>@team.ToArray()[item].Sev1ActiveCount</td>
                                                            }
                                                            @if (team.ToArray()[item].Sev2ActiveCount > 0)
                                                            {
                                                                <td>@Html.ActionLink(@team.ToArray()[item].Sev2ActiveCount.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "2", Status = "Active", TeamName = team.ToArray()[item].TeamVal }, null)</td>
                                                            }
                                                            else
                                                            {
                                                                <td>@team.ToArray()[item].Sev2ActiveCount</td>
                                                            }
                                                            @if (team.ToArray()[item].Sev3ActiveCount > 0)
                                                            {
                                                                <td>@Html.ActionLink(@team.ToArray()[item].Sev3ActiveCount.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "3", Status = "Active", TeamName = team.ToArray()[item].TeamVal }, null)</td>
                                                            }
                                                            else
                                                            {
                                                                <td>@team.ToArray()[item].Sev3ActiveCount</td>
                                                            }
                                                            @if (team.ToArray()[item].Sev4ActiveCount > 0)
                                                            {
                                                                <td>@Html.ActionLink(@team.ToArray()[item].Sev4ActiveCount.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "4", Status = "Active", TeamName = team.ToArray()[item].TeamVal }, null)</td>
                                                            }
                                                            else
                                                            {
                                                                <td>@team.ToArray()[item].Sev4ActiveCount</td>
                                                            }
                                                            <td>@Html.ActionLink(@team.ToArray()[item].ActiveTotal.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "Total", Status = "Active", TeamName = team.ToArray()[item].TeamVal }, new { @style = "color:orange;font-weight:bold;" })</td>
                                                        </tr>
                                                    }
                                                    @if (team.ToArray()[item].MitigatedTotal > 0)
                                                    {
                                                        <tr>
                                                            <td>Mitigated</td>
                                                            @if (team.ToArray()[item].Sev1MitigatedCount > 0)
                                                            {
                                                                <td>@Html.ActionLink(@team.ToArray()[item].Sev1MitigatedCount.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "1", Status = "Mitigated", TeamName = team.ToArray()[item].TeamVal }, null)</td>
                                                            }
                                                            else
                                                            {
                                                                <td>@team.ToArray()[item].Sev1MitigatedCount</td>
                                                            }
                                                            @if (team.ToArray()[item].Sev2MitigatedCount > 0)
                                                            {
                                                                <td>@Html.ActionLink(@team.ToArray()[item].Sev2MitigatedCount.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "2", Status = "Mitigated", TeamName = team.ToArray()[item].TeamVal }, null)</td>
                                                            }
                                                            else
                                                            {
                                                                <td>@team.ToArray()[item].Sev2MitigatedCount</td>
                                                            }
                                                            @if (team.ToArray()[item].Sev3MitigatedCount > 0)
                                                            {
                                                                <td>@Html.ActionLink(@team.ToArray()[item].Sev3MitigatedCount.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "3", Status = "Mitigated", TeamName = team.ToArray()[item].TeamVal }, null)</td>
                                                            }
                                                            else
                                                            {
                                                                <td>@team.ToArray()[item].Sev3MitigatedCount</td>
                                                            }
                                                            @if (team.ToArray()[item].Sev4MitigatedCount > 0)
                                                            {
                                                                <td>@Html.ActionLink(@team.ToArray()[item].Sev4MitigatedCount.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "4", Status = "Mitigated", TeamName = team.ToArray()[item].TeamVal }, null)</td>
                                                            }
                                                            else
                                                            {
                                                                <td>@team.ToArray()[item].Sev4MitigatedCount</td>
                                                            }
                                                            <td>@Html.ActionLink(@team.ToArray()[item].MitigatedTotal.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "Total", Status = "Mitigated", TeamName = team.ToArray()[item].TeamVal }, new { @style = "color:orange;font-weight:bold;" })</td>
                                                        </tr>
                                                    }
                                                    @if (team.ToArray()[item].ResolvedTotal > 0)
                                                    {
                                                        <tr>
                                                            <td>Resolved</td>
                                                            @if (team.ToArray()[item].Sev1ResolvedCount > 0)
                                                            {
                                                                <td>@Html.ActionLink(@team.ToArray()[item].Sev1ResolvedCount.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "1", Status = "Resolved", TeamName = team.ToArray()[item].TeamVal }, null)</td>
                                                            }
                                                            else
                                                            {
                                                                <td>@team.ToArray()[item].Sev1ResolvedCount</td>
                                                            }
                                                            @if (team.ToArray()[item].Sev2ResolvedCount > 0)
                                                            {
                                                                <td>@Html.ActionLink(@team.ToArray()[item].Sev2ResolvedCount.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "2", Status = "Resolved", TeamName = team.ToArray()[item].TeamVal }, null)</td>
                                                            }
                                                            else
                                                            {
                                                                <td>@team.ToArray()[item].Sev2ResolvedCount</td>
                                                            }
                                                            @if (team.ToArray()[item].Sev3ResolvedCount > 0)
                                                            {
                                                                <td>@Html.ActionLink(@team.ToArray()[item].Sev3ResolvedCount.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "3", Status = "Resolved", TeamName = team.ToArray()[item].TeamVal }, null)</td>
                                                            }
                                                            else
                                                            {
                                                                <td>@team.ToArray()[item].Sev3ResolvedCount</td>
                                                            }
                                                            @if (team.ToArray()[item].Sev4ResolvedCount > 0)
                                                            {
                                                                <td>@Html.ActionLink(@team.ToArray()[item].Sev4ResolvedCount.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "4", Status = "Resolved", TeamName = team.ToArray()[item].TeamVal }, null)</td>
                                                            }
                                                            else
                                                            {
                                                                <td>@team.ToArray()[item].Sev4ResolvedCount</td>
                                                            }
                                                            <td>@Html.ActionLink(@team.ToArray()[item].ResolvedTotal.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "Total", Status = "Resolved", TeamName = team.ToArray()[item].TeamVal }, new { @style = "color:orange;font-weight:bold;" })</td>
                                                        </tr>
                                                    }
                                                    @if (team.ToArray()[item].CFActiveTotal > 0)
                                                    {
                                                        <tr>
                                                            <td>Carry Forward</td>
                                                            @if (team.ToArray()[item].Sev1CFActiveCount > 0)
                                                            {
                                                                <td>@Html.ActionLink(@team.ToArray()[item].Sev1CFActiveCount.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "1", Status = "Active", IsCarry = "YES", TeamName = team.ToArray()[item].TeamVal }, null)</td>
                                                            }
                                                            else
                                                            {
                                                                <td>@team.ToArray()[item].Sev1CFActiveCount</td>
                                                            }
                                                            @if (team.ToArray()[item].Sev2CFActiveCount > 0)
                                                            {
                                                                <td>@Html.ActionLink(@team.ToArray()[item].Sev2CFActiveCount.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "2", Status = "Active", IsCarry = "YES", TeamName = team.ToArray()[item].TeamVal }, null)</td>
                                                            }
                                                            else
                                                            {
                                                                <td>@team.ToArray()[item].Sev2CFActiveCount</td>
                                                            }
                                                            @if (team.ToArray()[item].Sev3CFActiveCount > 0)
                                                            {
                                                                <td>@Html.ActionLink(@team.ToArray()[item].Sev3CFActiveCount.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "3", Status = "Active", IsCarry = "YES", TeamName = team.ToArray()[item].TeamVal }, null)</td>
                                                            }
                                                            else
                                                            {
                                                                <td>@team.ToArray()[item].Sev3CFActiveCount</td>
                                                            }
                                                            @if (team.ToArray()[item].Sev4CFActiveCount > 0)
                                                            {
                                                                <td>@Html.ActionLink(@team.ToArray()[item].Sev4CFActiveCount.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "4", Status = "Active", IsCarry = "YES", TeamName = team.ToArray()[item].TeamVal }, null)</td>
                                                            }
                                                            else
                                                            {
                                                                <td>@team.ToArray()[item].Sev4CFActiveCount</td>
                                                            }
                                                            <td>@Html.ActionLink(@team.ToArray()[item].CFActiveTotal.ToString(), "SREHandOffReport", "ICMHandOff", new { Severity = "Total", Status = "Active", IsCarry = "YES", TeamName = team.ToArray()[item].TeamVal }, new { @style = "color:orange;font-weight:bold;" })</td>
                                                        </tr>
                                                    }
                                                </table>
                                            </div>

                                        }
                                        else
                                        {
                                            ViewBag.NoData += team.ToArray()[item].TeamName + ", ";
                                        }
                                    }
                                </div>


                                @if (ViewBag.NoData != null)
                                {
                                    <div style="font-size:medium;color:red;text-align:center;">@ViewBag.NoData doesn't have any tickets</div>
                                }
                            </div>
                        </div>
                    </div>

                </div>
                <br />
                @if (ViewBag.KustoError != null && ViewBag.KustoError != "")
                {
                    <div style="font-size:medium;color:red;text-align:center;"> <marquee direction="right">@ViewBag.KustoError</marquee></div>
                }
                <div class="col-sm-12" style="padding:0;margin:0;">
                    <div class="mainText" id="mainTriage" style="background-color:#808080;">
                        @ViewBag.IcmType Queue
                        <div style="font-size:small;color:yellow">@Model.Shift Details: @Model.ShiftInfo (PST)</div>
                    </div>
                    <div class="divScroll">
                        @{
                            var gridHRep = new WebGrid(
                                                canPage: false,
                                                fieldNamePrefix: "tta",
                                                canSort: true,
                                                ajaxUpdateContainerId: "gridHRep"

                                                );

                            gridHRep.Bind(Model.TtaList, autoSortAndPage: false);

                            @gridHRep.GetHtml(htmlAttributes: new { id = "gridHRep", name = "grdHRep" },
                               fillEmptyRows: false,
                               tableStyle: "table table-bordered table-hover",
                               mode: WebGridPagerModes.All,
                               headerStyle: "info",
                               footerStyle: "webgrid-footer",
                               columns: gridHRep.Columns(
                               gridHRep.Column("IncidentNo", "Incident No", format:@<text><a href="https://portal.microsofticm.com/imp/v3/incidents/details/@item.IncidentNo/home" target="_blank">@item.IncidentNo</a></text>),
gridHRep.Column("Severity", "Severity"),
gridHRep.Column("Title", "Title", canSort: false), //format: @<text>@item.Title.ToString().Substring(0, (item.Title.Length > 50 ? 50 : item.Title.Length))</text>+ "..."),
gridHRep.Column("OwningContactAlias", "Owner"),
gridHRep.Column("Comments", canSort: false, format: @<text><label contenteditable="true" title="Enter your comments"></label></text>),
gridHRep.Column("Efforts", "Efforts"),
gridHRep.Column("OwningTeam", "Owning Team", canSort: false),
gridHRep.Column("Status", "Status", format: item => Html.Raw("<span class=" + item.Status + ">" + item.Status + "</span>")),
gridHRep.Column("IcmComment", "ICM Comment", canSort: false),
gridHRep.Column("IsCarryForward", "Is Carry Forward"),
gridHRep.Column("TicketAge", "Age"),
gridHRep.Column("ModifiedDate", "Modified Date")
)
)
                        }

                    </div>
                </div>
            </div>
            <br />
        }
        else
        {
            if (Model != null && Model.TtaList != null)
            {
                <div style="font-size:medium;color:red;text-align:center;"> <marquee direction="right">During this time we dont have any data available</marquee></div>
            }
        }


    </div>

}


