let start= datetime(@fromDate); 
let end= datetime(@toDate);
let SeverityDowngrade=()
{
let a =materialize(Incidents |where OwningTeamName in("SKYPEFORBUSINESS\\IC3ProvisioningTriage","SKYPEFORBUSINESS\\RTCAPPSRE") and CreateDate >= start and CreateDate <= end | summarize arg_min(ModifiedDate, *) by IncidentId);
a | join IncidentHistory  on IncidentId
| where CreateDate >= start and CreateDate <= end and ChangeCategories contains "SeverityDowngrade" 
| summarize arg_max(ChangeDate,*) by IncidentId 
| project IncidentId,CreateDate,ChangeDate,Severity,OwningTeamName,Format='SeverityDowngrade' 
};
let SeverityUpgrade=()
{
let b =materialize(Incidents |where OwningTeamName in("SKYPEFORBUSINESS\\IC3ProvisioningTriage","SKYPEFORBUSINESS\\RTCAPPSRE") and CreateDate >= start and CreateDate <= end | summarize arg_max(ModifiedDate, *) by IncidentId | project IncidentId,CreateDate,Severity,OwningTeamName );
b  | join IncidentHistory  on IncidentId
| where CreateDate >= start and CreateDate <= end and ChangeCategories contains "SeverityUpgrade"  
| summarize arg_max(ChangeDate,*) by IncidentId 
| project IncidentId,CreateDate,ChangeDate,Severity,OwningTeamName,Format='SeverityUpgrade' 
};
SeverityDowngrade | union SeverityUpgrade
|order by Format asc